<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Landscape Fire Hazard Model - Firekit • firekit</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Landscape Fire Hazard Model - Firekit">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">firekit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2.600</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/landscape_model.html">Landscape Fire Hazard Model - Firekit</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Landscape Fire Hazard Model - Firekit</h1>
            
      

      <div class="d-none name"><code>landscape_model.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fire-centre.github.io/firekit/">firekit</a></span><span class="op">)</span></span></code></pre></div>
<p>This guide will explain how to use the radiant heat and firebrand
(ember) impact models within the <em>firekit</em> R package developed by
the UTAS Fire Centre. This process allows you to attribute houses with
indices of risk of radiant heat impact (based on a threshold of 12.5
kwm2) and ember impact (based on 95%ile distance), given suitable input
spatial data layers and forest fuel load definitions.</p>
<p>The first step is to install the <em>firekit</em> package in R. This
package has not yet been submitted to the CRAN archive, but it is
available to install directly from Github using the <em>devtools</em>
package. If you don’t have <em>devtools</em> installed, install it first
using the <strong>install.packages()</strong> function:</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span></code></pre>
<p>After it has installed, use it to install <em>firekit</em> directly
from the UTAS Fire Centre Github repository</p>
<pre><code><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"Fire-Centre/firekit"</span>,force<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fire-centre.github.io/firekit/">firekit</a></span><span class="op">)</span></span></code></pre>
<p>A few other R packages are required to run this demonstration
exercise, the <em>tidyverse</em> package for general data manipulation,
and the <em>terra</em> and <em>sf</em> packages for spatial data.</p>
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span></code></pre>
<p>Next we can load the data files required for this analysis. This are
available in a ZIP file, which you can unzip into the
<strong>data</strong> folder of your project directory.</p>
<p>First, a digital elevation model of the area surrounding our example
properties.</p>
<pre><code><span><span class="va">dem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="st">"data/dem.tif"</span><span class="op">)</span></span></code></pre>
<p>Next, the locations of the houses themselves. This spatial database
include a unique ID number for each house.</p>
<pre><code><span><span class="va">houses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span><span class="st">"data/houses.gpkg"</span><span class="op">)</span></span></code></pre>
<p>We also need a polygon vegetation map of the surrounding area. Our
vegetation mapping is very simple in this example, it is derived from
the TasVeg 4.0 mapping, incorporating the broad vegetation group, which
is mostly Dry and Wet Eucalyptus Forest in our study area. In our
example vegetation map, urban/modified land has been removed and only
flammable vegetation is retained. However, this isn’t strictly
necessary, as the property processing function can be told to ignore
certain land use categories and regard them as urban. <strong>Note - the
vegetation data input file should have a field called VEG_GROUP
containing the vegetation classes that drive the modelling.</strong></p>
<pre><code><span><span class="va">veg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span><span class="st">"data/veg.gpkg"</span><span class="op">)</span></span></code></pre>
<p>Finally, we have a database of fuel types and loads. In our example
this is very simple, there are just a few broad, basic types defined.
There are a few vital fields in this file.</p>
<ul>
<li>
<p><strong>Vegetation_Category</strong> - this selects the fuel
model to use in the radiant heat simulation, and can contain one of four
types;</p>
<ul>
<li><p>Forest, Rainforest and Woodland</p></li>
<li><p>Shrub, Scrub and Heath</p></li>
<li><p>Grassland</p></li>
<li><p>Tussock Moorland</p></li>
</ul>
</li>
<li><p><strong>Vegetation_Community</strong> - this is the fine-scale
vegetation class, each with unique fuel loads. Importantly, this joins
with and should therefore contain the same names as the
<strong>VEG_GROUP</strong> field in the vegetation spatial
layer.</p></li>
<li><p><strong>SFFL</strong> - Surface Fine Fuel Load in t/ha</p></li>
<li><p><strong>OFFL</strong> - Overall Fine Fuel Load in t/ha</p></li>
<li><p><strong>HGT</strong> - A specific field for shrubby/heath fuels,
indicating the layer height in metres. For other fuel types (eg.
forests) set this to -1.</p></li>
</ul>
<p>Next, we use the <strong>generate_property_fields()</strong> function
to supplement the house location data with geographic data required for
the risk modelling - for example, nearby fuel typesa nd distances,
slope, and slope type. The output table generated by this may contain
multiple records for each house, if vegetation is identified nearby in
multiple directions. Later functions will collate these multiple records
and identify the one with the highest radiant heat risk.</p>
<p>In the function parameters, the “urb_types” parameter contains a list
of <strong>VEG_GROUP</strong> categories that are considered urban/no
fuel/no fire risk. The “urb_set” parameter then defines a single type
those multiple no-fuel types should be combined into for simplicity. The
“id_field” is the name of a unique ID field in the spatial data that can
be used for later collation and joining, while the “fr_angle” is the
direction to search for the maximum fire-run distance. In our case, we
use the direction of typical extreme fire weatehr approach for the
location (Hobart) which is north-west, 315 degrees.</p>
<pre><code><span><span class="va">sup_houses</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_property_fields.html">generate_property_fields</a></span><span class="op">(</span>locations<span class="op">=</span><span class="va">houses</span>,</span>
<span>                             dem<span class="op">=</span><span class="va">dem</span>,</span>
<span>                             veg<span class="op">=</span><span class="va">veg</span>,</span>
<span>                             urb_types<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Other natural environments"</span>, </span>
<span>                                         <span class="st">"Agricultural, urban and exotic vegetation"</span>, <span class="st">"Modified land"</span><span class="op">)</span>,</span>
<span>                             urb_set<span class="op">=</span><span class="st">"Agricultural, urban and exotic vegetation"</span>,</span>
<span>                             id_field<span class="op">=</span><span class="st">"UniquID"</span>,</span>
<span>                             fr_angle<span class="op">=</span><span class="fl">315</span><span class="op">)</span></span></code></pre>
<p>We need to add an additional field to the attribute table that has
been geenrated which contains the <strong>fuel break class</strong> (see
TFS fuel break width calculator documentation). Here we will set this to
“class1” for all properties, indicating unmanaged fuel. Note that this
field is not as important when we are modelling for an explicit forest
fire danger index (FFDI) as we do in this example, because within the
algorithm, the class type defines one of several fire danger levels, but
here we set that fire danger ourselves.</p>
<pre><code><span><span class="va">sup_houses</span><span class="op">$</span><span class="va">fb_class</span> <span class="op">&lt;-</span> <span class="st">"class1"</span></span></code></pre>
<p>Next we use the <strong>calc_rad_risk_FFDI()</strong> function to
calculate the radiant heat received under the conditions of interest.
The output data frame contains a number of fields that have been added
to the data:</p>
<ul>
<li><p><strong>FBW </strong>- required fuel break width to protect this
property, in metres</p></li>
<li><p><strong>FL </strong>- calculated fireline intensity for this
property</p></li>
<li><p><strong>DRisk </strong>- diferential radiant heat index. This is
the difference between the required distance from the vegetation to be
below 12.5 kwm2, and the actual distance. Negative values, therefore,
mean house is further away than required and is therefore low risk,
while positive values indicate the house is close enough to have radiant
heat impact under these conditions.</p></li>
</ul>
<p>We run this function using the fuel database, and a set FFDI of
50.</p>
<pre><code><span><span class="va">rad_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rad_risk_FFDI.html">calc_rad_risk_FFDI</a></span><span class="op">(</span><span class="va">sup_houses</span>,<span class="va">fuel</span>,<span class="fl">50</span><span class="op">)</span></span></code></pre>
<p>Next we will add the ember model risk index. First, we need to join
the fuel load data for this table, so we know the fuel load of the
vegetation proximate to each house in the nearby vegetation.</p>
<pre><code><span><span class="va">rad_output</span> <span class="op">&lt;-</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">rad_output</span>,<span class="va">fuel</span>,<span class="fu">join_by</span><span class="op">(</span><span class="va">VEG_GROUP</span><span class="op">==</span><span class="va">Vegetation_Community</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<p>We also need to reclassify the slope type to the “Flat/Hilly”
definition used in the ember model.</p>
<pre><code><span><span class="va">rad_output</span> <span class="op">&lt;-</span> <span class="va">rad_output</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">mutate</span><span class="op">(</span>slope_emb <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span><span class="va">slope_type</span>  <span class="op">==</span> <span class="st">"downslope"</span> <span class="op">~</span> <span class="st">"Hilly"</span>,</span>
<span>                                                          <span class="va">slope_type</span> <span class="op">==</span> <span class="st">"flat"</span> <span class="op">~</span> <span class="st">"Flat"</span>,</span>
<span>                                                          <span class="va">slope_type</span> <span class="op">==</span> <span class="st">"level"</span> <span class="op">~</span> <span class="st">"Flat"</span>,</span>
<span>                                                          <span class="va">slope_type</span> <span class="op">==</span> <span class="st">"upslope"</span> <span class="op">~</span> <span class="st">"Flat"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<p>Finally, we can add a new field to the table to contain the outputs,
and loop through each house to calculate the ember impact distance.</p>
<pre><code><span><span class="va">rad_output</span><span class="op">$</span><span class="va">ember_dist</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">rad_output</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">rad_output</span><span class="op">$</span><span class="va">ember_dist</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_ember.html">predict_ember</a></span><span class="op">(</span><span class="fl">50</span>,<span class="va">rad_output</span><span class="op">$</span><span class="va">slope_emb</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">rad_output</span><span class="op">$</span><span class="va">SFFL</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
<p>The ember risk field can then be added by simple subtraction; this
works the same as for radiant heat, if ember distance is greater than
the distance to vegetation, then there is ember risk. Negative risk
values indicate low risk, while positive risk values indicate high
risk.</p>
<pre><code><span><span class="va">rad_output</span><span class="op">$</span><span class="va">ERisk</span> <span class="op">=</span> <span class="va">rad_output</span><span class="op">$</span><span class="va">ember_dist</span> <span class="op">-</span> <span class="va">rad_output</span><span class="op">$</span><span class="va">dist</span></span></code></pre>
<p>We can then join that output back to the spatial data, and plot some
maps of ember and radiant heat impact indices.</p>
<pre><code><span><span class="va">houses</span> <span class="op">&lt;-</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">houses</span>,<span class="va">rad_output</span>,<span class="fu">join_by</span><span class="op">(</span><span class="va">UniquID</span><span class="op">==</span><span class="va">id</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">houses</span><span class="op">[</span><span class="st">"ERisk"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">houses</span><span class="op">[</span><span class="st">"DRisk"</span><span class="op">]</span><span class="op">)</span></span></code></pre>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Todd Ellis, Grant Williamson, Amila Wickramasinghe, Stefania Ondei.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
